i32 KMP(ptr dst, ptr src) {
entry48:
  %j52 = stack 4
  %i51 = stack 4
  %next = stack 16384
  call void get_next(ptr %dst, ptr %next)
  store i32 0 to ptr %i51
  store i32 0 to ptr %j52
  br bb %while.cond53
while.cond53:
  j52.load = load i32 from ptr %j52
  57 = mul i32 %j52.load, i32 4
  58 = ptradd ptr %src, i32 %57
  58.load = load i32 from ptr %58
  60 = icmp ne i32 %58.load, i32 0
  br i1 %60, bb %while.body54, bb %while.exit55
while.body54:
  i51.load = load i32 from ptr %i51
  62 = mul i32 %i51.load, i32 4
  63 = ptradd ptr %dst, i32 %62
  63.load = load i32 from ptr %63
  j52.load65 = load i32 from ptr %j52
  66 = mul i32 %j52.load65, i32 4
  67 = ptradd ptr %src, i32 %66
  67.load = load i32 from ptr %67
  69 = icmp eq i32 %63.load, i32 %67.load
  br i1 %69, bb %then70, bb %else72
while.exit55:
  101 = sub i32 0, i32 1
  ret i32 %101
then70:
  i51.load73 = load i32 from ptr %i51
  74 = add i32 %i51.load73, i32 1
  store i32 %74 to ptr %i51
  j52.load75 = load i32 from ptr %j52
  76 = add i32 %j52.load75, i32 1
  store i32 %76 to ptr %j52
  78 = mul i32 %74, i32 4
  79 = ptradd ptr %dst, i32 %78
  79.load = load i32 from ptr %79
  81 = icmp ne i32 %79.load, i32 0
  82 =  i1 %81, i1 1
  83 = zext i1 %82 to i32
  84 = icmp ne i32 %83, i32 0
  br i1 %84, bb %then85, bb %if.exit86
if.exit71:
  br bb %while.cond53
else72:
  i51.load88 = load i32 from ptr %i51
  89 = mul i32 %i51.load88, i32 4
  90 = ptradd ptr %next, i32 %89
  90.load = load i32 from ptr %90
  store i32 %90.load to ptr %i51
  93 = sub i32 0, i32 1
  94 = icmp eq i32 %90.load, i32 %93
  br i1 %94, bb %then95, bb %if.exit96
then85:
  j52.load87 = load i32 from ptr %j52
  ret i32 %j52.load87
if.exit86:
  br bb %if.exit71
then95:
  i51.load97 = load i32 from ptr %i51
  98 = add i32 %i51.load97, i32 1
  store i32 %98 to ptr %i51
  j52.load99 = load i32 from ptr %j52
  100 = add i32 %j52.load99, i32 1
  store i32 %100 to ptr %j52
  br bb %if.exit96
if.exit96:
  br bb %if.exit71
}

external i32 getint()

external i32 getch()

i32 read_str(ptr buf) {
entry102:
  %i103 = stack 4
  store i32 0 to ptr %i103
  br bb %while.cond104
while.cond104:
  107 = icmp ne i32 1, i32 0
  br i1 %107, bb %while.body105, bb %while.exit106
while.body105:
  i103.load = load i32 from ptr %i103
  109 = mul i32 %i103.load, i32 4
  110 = ptradd ptr %buf, i32 %109
  111 = call i32 getch()
  store i32 %111 to ptr %110
  i103.load112 = load i32 from ptr %i103
  113 = mul i32 %i103.load112, i32 4
  114 = ptradd ptr %buf, i32 %113
  114.load = load i32 from ptr %114
  116 = icmp eq i32 %114.load, i32 10
  br i1 %116, bb %then117, bb %if.exit118
while.exit106:
  i103.load121 = load i32 from ptr %i103
  122 = mul i32 %i103.load121, i32 4
  123 = ptradd ptr %buf, i32 %122
  store i32 0 to ptr %123
  i103.load124 = load i32 from ptr %i103
  ret i32 %i103.load124
then117:
  br bb %while.exit106
if.exit118:
  i103.load119 = load i32 from ptr %i103
  120 = add i32 %i103.load119, i32 1
  store i32 %120 to ptr %i103
  br bb %while.cond104
}

external void putint(i32 )

external i32 getfarray(ptr )

i32 main() {
entry125:
  %src = stack 16384
  %dst = stack 16384
  128 = call i32 read_str(ptr %dst)
  129 = call i32 read_str(ptr %src)
  130 = call i32 KMP(ptr %dst, ptr %src)
  call void putint(i32 %130)
  call void putch(i32 10)
  ret i32 0
}

external float getfloat()

external void putfloat(float )

external void putch(i32 )

external void _sysy_stoptime(i32 )

external void putarray(i32 , ptr )

external void _sysy_starttime(i32 )

external void putfarray(i32 , ptr )

external i32 getarray(ptr )

void get_next(ptr str, ptr next) {
entry:
  %select = stack 1
  %j = stack 4
  %i = stack 4
  1 = mul i32 0, i32 4
  2 = ptradd ptr %next, i32 %1
  3 = sub i32 0, i32 1
  store i32 %3 to ptr %2
  store i32 0 to ptr %i
  6 = sub i32 0, i32 1
  store i32 %6 to ptr %j
  br bb %while.cond
while.cond:
  i.load = load i32 from ptr %i
  11 = mul i32 %i.load, i32 4
  12 = ptradd ptr %str, i32 %11
  12.load = load i32 from ptr %12
  14 = icmp ne i32 %12.load, i32 0
  br i1 %14, bb %while.body, bb %while.exit
while.body:
  j.load = load i32 from ptr %j
  16 = sub i32 0, i32 1
  17 = icmp eq i32 %j.load, i32 %16
  br i1 %17, bb %select.then, bb %select.else
while.exit:
  ret 
select.then:
  store i1 1 to ptr %select
  br bb %select.exit
select.else:
  i.load22 = load i32 from ptr %i
  23 = mul i32 %i.load22, i32 4
  24 = ptradd ptr %str, i32 %23
  24.load = load i32 from ptr %24
  j.load26 = load i32 from ptr %j
  27 = mul i32 %j.load26, i32 4
  28 = ptradd ptr %str, i32 %27
  28.load = load i32 from ptr %28
  30 = icmp eq i32 %24.load, i32 %28.load
  31 = icmp ne i1 %30, i1 0
  store i1 %31 to ptr %select
  br bb %select.exit
select.exit:
  32 = load i1 from ptr %select
  br i1 %32, bb %then, bb %else
then:
  j.load36 = load i32 from ptr %j
  37 = add i32 %j.load36, i32 1
  store i32 %37 to ptr %j
  i.load38 = load i32 from ptr %i
  39 = add i32 %i.load38, i32 1
  store i32 %39 to ptr %i
  41 = mul i32 %39, i32 4
  42 = ptradd ptr %next, i32 %41
  store i32 %37 to ptr %42
  br bb %if.exit
if.exit:
  br bb %while.cond
else:
  j.load44 = load i32 from ptr %j
  45 = mul i32 %j.load44, i32 4
  46 = ptradd ptr %next, i32 %45
  46.load = load i32 from ptr %46
  store i32 %46.load to ptr %j
  br bb %if.exit
}


